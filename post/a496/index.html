<!DOCTYPE html>



  


<html class="theme-next mist use-motion" lang="en">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="google-site-verification" content="IOATCl5WoBxLBupME1kt4CHNSMNPlQtjHsNC-UXFvUQ">
<meta name="theme-color" content="#222">

  
  
    
    
  <script src="/lib/pace/pace.min.js?v=1.0.2"></script>
  <link href="/lib/pace/pace-theme-minimal.min.css?v=1.0.2" rel="stylesheet">



<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">






  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">





<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">
<link href="/css/main.css?v=5.1.3" rel="stylesheet" type="text/css">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.3">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.3" color="#222">




  <meta name="keywords" content="Distributed,">



  <link rel="alternate" href="/atom.xml" title="Shunyang Li" type="application/atom+xml">


<meta name="description" content="Flink GellyGelly is Flink’s Graph API. It contains a set of methods and utilities designed to simplify the development of graph analysis applications in Flink. In Gelly, graphs can be converted and mo">
<meta name="keywords" content="Distributed">
<meta property="og:type" content="article">
<meta property="og:title" content="Flink Gelly">
<meta property="og:url" content="https://shunyangli.github.io/post/a496/index.html">
<meta property="og:site_name" content="Shunyang Li">
<meta property="og:description" content="Flink GellyGelly is Flink’s Graph API. It contains a set of methods and utilities designed to simplify the development of graph analysis applications in Flink. In Gelly, graphs can be converted and mo">
<meta property="og:locale" content="en">
<meta property="og:updated_time" content="2022-09-01T11:16:54.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Flink Gelly">
<meta name="twitter:description" content="Flink GellyGelly is Flink’s Graph API. It contains a set of methods and utilities designed to simplify the development of graph analysis applications in Flink. In Gelly, graphs can be converted and mo">

<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '5.1.3',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  <link rel="canonical" href="https://shunyangli.github.io/post/a496/">




  
  <link href="//fonts.googleapis.com/css?family=Kaushan+Script" rel="stylesheet" type="text/css">
  <title>Flink Gelly | Shunyang Li</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>
    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    
    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Shunyang Li</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <h1 class="site-subtitle" itemprop="description"></h1>
      
  </div>
  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>
<nav class="site-nav">
  
  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br>
            
            About
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            Tags
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            Categories
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            Archives
          </a>
        </li>
      
      
    </ul>
  
  
</nav>


 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://shunyangli.github.io/post/a496/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Shunyang Li">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Shunyang Li">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">Flink Gelly</h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2022-08-27T23:05:38+10:00">
                2022-08-27
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/post/a496/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/post/a496/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          
            <span class="post-meta-divider">|</span>
            <span class="page-pv"><i class="fa fa-file-o"></i> Total number of readers of this article
            <span class="busuanzi-value" id="busuanzi_value_page_pv"></span>times
            </span>
          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Words count in article&#58;</span>
                
                <span title="Words count in article">
                  2.3k words
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Reading time &asymp;</span>
                
                <span title="Reading time">
                  14 minutes
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h1 id="Flink-Gelly"><a href="#Flink-Gelly" class="headerlink" title="Flink Gelly"></a>Flink Gelly</h1><p>Gelly is Flink’s Graph API. It contains a set of methods and utilities designed to simplify the development of graph analysis applications in Flink. In Gelly, graphs can be converted and modified using advanced functions similar to those provided by the batch API. gelly provides methods for creating, converting and modifying graphs, as well as a library of graph algorithms.</p>
<h1 id="Load-Graph"><a href="#Load-Graph" class="headerlink" title="Load Graph"></a>Load Graph</h1><p>In Gelly, a <code>Graph</code> is consist of <code>DataSet</code> vertices and <code>DataSet</code> Edges. <code>Vertex</code> is implement based on <code>Tuple2</code>. <code>Edge</code> is implement based on <code>Tuple3</code>. A <code>Vertex</code> is defined by a unique ID and a value. Vertex IDs should implement the Comparable interface. Vertices without value can be represented by setting the value type to NullValue. An <code>Edge</code> is defined by a source ID (the ID of the source Vertex), a target ID (the ID of the target Vertex) and an optional value. The source and target IDs should be of the same type as the Vertex IDs. Edges with no value have a NullValue value type. (<a href="https://nightlies.apache.org/flink/flink-docs-release-1.15/docs/libs/gelly/graph_api/" target="_blank" rel="noopener">https://nightlies.apache.org/flink/flink-docs-release-1.15/docs/libs/gelly/graph_api/</a>).</p>
<p><code>Graph</code> can be loaded based on <code>DataSet&lt;Vertex&lt;K, VV&gt;&gt;</code> or <code>fromTupleDataSet</code>. To make it easier and faster to load graphs, we can use <code>csv</code> file to load the graph.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ExecutionEnvironment env = ExecutionEnvironment.getExecutionEnvironment();</span><br><span class="line">Graph&lt;Long, Long, Long&gt; graph = Graph.fromCsvReader(<span class="string">"data\\taro.v"</span>, <span class="string">"data\\taro.e"</span>, env)</span><br><span class="line">                .types(Long.class, Long.class, Long.class);</span><br></pre></td></tr></table></figure>

<p>The data graph format shown below.</p>
<p>For vertices file:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1,1</span><br><span class="line">2,2</span><br><span class="line">3,3</span><br><span class="line">4,4</span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<p>For edges file:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1,2,0</span><br><span class="line">1,3,0</span><br><span class="line">1,4,0</span><br><span class="line">2,3,0</span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<h1 id="Tips"><a href="#Tips" class="headerlink" title="Tips"></a>Tips</h1><p>When load the graph with generic type. For example, use <code>fatMap</code> to load the graph. It is possible that you may encounter the following problems:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Caused by: org.apache.flink.api.common.functions.InvalidTypesException: Type of TypeVariable <span class="string">'K'</span> in <span class="string">'class org.dkr.graph.io.utils.VertexSplitter'</span> could not be determined. This is most likely a type erasure problem. <span class="function">The type extraction currently supports types with generic variables only in cases where all variables in the return type can be deduced from the input <span class="title">type</span><span class="params">(s)</span>. Otherwise the type has to be specified explicitly using type information.</span></span><br></pre></td></tr></table></figure>

<p>When this problem is encountered, it can be solved by declaring the return data type. For example:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">DataSet&lt;Tuple2&lt;K, VV&gt;&gt; vertices = data</span><br><span class="line">        .flatMap(<span class="keyword">new</span> FlatMapFunction())</span><br><span class="line">        .returns(Types.TUPLE(TypeInformation.of(dataType), TypeInformation.of(dataType)))</span><br></pre></td></tr></table></figure>

<p>Another weird issue is that if you use <code>Edge&lt;K, EV&gt;</code> to load edges data, you only have two data types inside your Edge Object (vertex ID type and edge value type). This problem cannot be solved by using <code>returns</code> function. This issue will cause some functions to be unusable, such as <code>graph.inDegrees()</code>. <strong>You can use Tuple&lt;K, K, EV&gt; instead of Edge&lt;K, EV&gt; to solve this issue.</strong> </p>
<h1 id="Basic-Graph-Algorithms"><a href="#Basic-Graph-Algorithms" class="headerlink" title="Basic Graph Algorithms"></a>Basic Graph Algorithms</h1><h2 id="BFS"><a href="#BFS" class="headerlink" title="BFS"></a>BFS</h2><p>There are two approaches two deisgn the <code>BFS</code> algorithm in <code>Gelly</code>. We can use <code>runVertexCentricIteration</code> or <code>runScatterGatherIteration</code>. </p>
<h3 id="runVertexCentricIteration-Approach"><a href="#runVertexCentricIteration-Approach" class="headerlink" title="runVertexCentricIteration Approach:"></a><code>runVertexCentricIteration</code> Approach:</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.apache.flink.api.common.functions.MapFunction;</span><br><span class="line"><span class="keyword">import</span> org.apache.flink.graph.Edge;</span><br><span class="line"><span class="keyword">import</span> org.apache.flink.graph.Graph;</span><br><span class="line"><span class="keyword">import</span> org.apache.flink.graph.Vertex;</span><br><span class="line"><span class="keyword">import</span> org.apache.flink.graph.pregel.ComputeFunction;</span><br><span class="line"><span class="keyword">import</span> org.apache.flink.graph.pregel.MessageCombiner;</span><br><span class="line"><span class="keyword">import</span> org.apache.flink.graph.pregel.MessageIterator;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BFS</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Long src = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">private</span>  <span class="keyword">int</span> maxInteractions = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">BFSV</span><span class="params">(<span class="keyword">int</span> maxInteractions, Long src)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.src = src;</span><br><span class="line">        <span class="keyword">this</span>.maxInteractions = maxInteractions;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Graph&lt;Long, Long, Long&gt; <span class="title">run</span><span class="params">(Graph&lt;Long, Long, Long&gt; graph)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> graph</span><br><span class="line">                .mapVertices(<span class="keyword">new</span> InitVertex(<span class="keyword">this</span>.src))</span><br><span class="line">                .runVertexCentricIteration(<span class="keyword">new</span> VertexComputeFunction(<span class="keyword">this</span>.src), <span class="keyword">new</span> VertexValueCombiner(), <span class="keyword">this</span>.maxInteractions);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">InitVertex</span> <span class="keyword">implements</span> <span class="title">MapFunction</span>&lt;<span class="title">Vertex</span>&lt;<span class="title">Long</span>, <span class="title">Long</span>&gt;, <span class="title">Long</span>&gt; </span>&#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">final</span> Long src;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">InitVertex</span><span class="params">(Long src)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.src = src;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> Long <span class="title">map</span><span class="params">(Vertex&lt;Long, Long&gt; value)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (value.getId().equals(<span class="keyword">this</span>.src)) <span class="keyword">return</span> <span class="number">1L</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0L</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * send message and update the values.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">VertexComputeFunction</span> <span class="keyword">extends</span> <span class="title">ComputeFunction</span>&lt;<span class="title">Long</span>, <span class="title">Long</span>, <span class="title">Long</span>, <span class="title">Long</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">final</span> Long src;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">VertexComputeFunction</span><span class="params">(Long src)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.src = src;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">compute</span><span class="params">(Vertex&lt;Long, Long&gt; vertex, MessageIterator&lt;Long&gt; messages)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (vertex.getId().equals(<span class="keyword">this</span>.src)) &#123;</span><br><span class="line">                <span class="keyword">for</span> (Edge&lt;Long, Long&gt; edge : getEdges()) &#123;</span><br><span class="line">                    sendMessageTo(edge.getTarget(), vertex.getValue() + <span class="number">1L</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line"></span><br><span class="line">                Long minDistance =  Long.MAX_VALUE;</span><br><span class="line">                <span class="keyword">for</span> (Long msg : messages) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (msg &lt; minDistance) &#123;</span><br><span class="line">                        minDistance = msg;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="comment">// does not receive any new values</span></span><br><span class="line">                <span class="keyword">if</span> (minDistance == Long.MAX_VALUE) <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (vertex.getValue() &gt; minDistance || vertex.getValue() == <span class="number">0L</span>) &#123;</span><br><span class="line">                    setNewVertexValue(minDistance);</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">for</span> (Edge&lt;Long, Long&gt; edge : getEdges()) &#123;</span><br><span class="line">                        <span class="comment">// can not use vertex value to update.</span></span><br><span class="line">                        sendMessageTo(edge.getTarget(), minDistance + <span class="number">1L</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * combiner for vertex's message, choose the smallest one</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">VertexValueCombiner</span> <span class="keyword">extends</span> <span class="title">MessageCombiner</span>&lt;<span class="title">Long</span>, <span class="title">Long</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">combineMessages</span><span class="params">(MessageIterator&lt;Long&gt; messages)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">            Long minDistance = Long.MAX_VALUE;</span><br><span class="line">            <span class="keyword">for</span> (Long msg : messages) &#123;</span><br><span class="line">                <span class="keyword">if</span> (msg &lt; minDistance) &#123;</span><br><span class="line">                    minDistance = msg;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            sendCombinedMessage(minDistance);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="runScatterGatherIteration-Approach"><a href="#runScatterGatherIteration-Approach" class="headerlink" title="runScatterGatherIteration Approach:"></a><code>runScatterGatherIteration</code> Approach:</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.apache.flink.api.common.functions.MapFunction;</span><br><span class="line"><span class="keyword">import</span> org.apache.flink.graph.Edge;</span><br><span class="line"><span class="keyword">import</span> org.apache.flink.graph.Graph;</span><br><span class="line"><span class="keyword">import</span> org.apache.flink.graph.Vertex;</span><br><span class="line"><span class="keyword">import</span> org.apache.flink.graph.spargel.GatherFunction;</span><br><span class="line"><span class="keyword">import</span> org.apache.flink.graph.spargel.MessageIterator;</span><br><span class="line"><span class="keyword">import</span> org.apache.flink.graph.spargel.ScatterFunction;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BFS</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Long src = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">private</span>  <span class="keyword">int</span> maxInteractions = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">BFS</span><span class="params">(<span class="keyword">int</span> maxInteractions, Long src)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.src = src;</span><br><span class="line">        <span class="keyword">this</span>.maxInteractions = maxInteractions;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * return a new graph with the bfs traversal order</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> graph input data graph</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> a new graph</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Graph&lt;Long, Long, Long&gt; <span class="title">run</span><span class="params">(Graph&lt;Long, Long, Long&gt; graph)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> graph</span><br><span class="line">                .mapVertices(<span class="keyword">new</span> InitVertex(<span class="keyword">this</span>.src))</span><br><span class="line">                .runScatterGatherIteration(<span class="keyword">new</span> MapOrderMessenger(), <span class="keyword">new</span> VertexOrderUpdater(), <span class="keyword">this</span>.maxInteractions);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * init the vertex value, the vertex value present the traversal order</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">InitVertex</span> <span class="keyword">implements</span> <span class="title">MapFunction</span>&lt;<span class="title">Vertex</span>&lt;<span class="title">Long</span>, <span class="title">Long</span>&gt;, <span class="title">Long</span>&gt; </span>&#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">final</span> Long src;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">InitVertex</span><span class="params">(Long src)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.src = src;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> Long <span class="title">map</span><span class="params">(Vertex&lt;Long, Long&gt; value)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (value.getId().equals(<span class="keyword">this</span>.src)) <span class="keyword">return</span> <span class="number">1L</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0L</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * traversal the vertex, if it has been visited, then send the traversal order to its neighbor</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">MapOrderMessenger</span> <span class="keyword">extends</span> <span class="title">ScatterFunction</span>&lt;<span class="title">Long</span>, <span class="title">Long</span>, <span class="title">Long</span>, <span class="title">Long</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sendMessages</span><span class="params">(Vertex&lt;Long, Long&gt; vertex)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (vertex.getValue() &gt; <span class="number">0L</span>) &#123;</span><br><span class="line">                <span class="keyword">for</span> (Edge&lt;Long, Long&gt; edge : getEdges()) &#123;</span><br><span class="line">                    sendMessageTo(edge.getTarget(), vertex.getValue() + <span class="number">1L</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * based on the received message, then update the vertex value</span></span><br><span class="line"><span class="comment">     * since the processing is parallel, the received value can be multiple time, choose the smallest one</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">VertexOrderUpdater</span> <span class="keyword">extends</span> <span class="title">GatherFunction</span>&lt;<span class="title">Long</span>, <span class="title">Long</span>, <span class="title">Long</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">updateVertex</span><span class="params">(Vertex&lt;Long, Long&gt; vertex, MessageIterator&lt;Long&gt; inMessages)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line"></span><br><span class="line">            Long minDistance = Long.MAX_VALUE;</span><br><span class="line">            <span class="keyword">for</span> (Long msg : inMessages) &#123;</span><br><span class="line">                <span class="keyword">if</span> (msg &lt; minDistance) &#123;</span><br><span class="line">                    minDistance = msg;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (vertex.getValue() &gt; minDistance || vertex.getValue() == <span class="number">0L</span>) &#123;</span><br><span class="line">                setNewVertexValue(minDistance);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>For the usage of these functions, please refer to <a href="https://nightlies.apache.org/flink/flink-docs-release-1.15/docs/libs/gelly/iterative_graph_processing/" target="_blank" rel="noopener">doc</a></p>
<h2 id="K-core-Decomposition"><a href="#K-core-Decomposition" class="headerlink" title="K-core Decomposition"></a>K-core Decomposition</h2><blockquote>
<p>A k-core of G can therefore be obtained by recursively removing all the vertices of degree less than k, until<br>all vertices in the remaining graph have at least degree k (<a href="https://hal.archives-ouvertes.fr/hal-00004807v2/document" target="_blank" rel="noopener">https://hal.archives-ouvertes.fr/hal-00004807v2/document</a>)</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.flink.api.common.functions.FilterFunction;</span><br><span class="line"><span class="keyword">import</span> org.apache.flink.graph.Edge;</span><br><span class="line"><span class="keyword">import</span> org.apache.flink.graph.Graph;</span><br><span class="line"><span class="keyword">import</span> org.apache.flink.graph.Vertex;</span><br><span class="line"><span class="keyword">import</span> org.apache.flink.graph.VertexJoinFunction;</span><br><span class="line"><span class="keyword">import</span> org.apache.flink.graph.spargel.GatherFunction;</span><br><span class="line"><span class="keyword">import</span> org.apache.flink.graph.spargel.MessageIterator;</span><br><span class="line"><span class="keyword">import</span> org.apache.flink.graph.spargel.ScatterFunction;</span><br><span class="line"><span class="keyword">import</span> org.apache.flink.types.LongValue;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Objects;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">KCore</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> Long k;</span><br><span class="line">    <span class="keyword">private</span>  <span class="keyword">int</span> maxInteractions = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">KCore</span><span class="params">(<span class="keyword">int</span> maxInteractions, Long k)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.k = k;</span><br><span class="line">        <span class="keyword">this</span>.maxInteractions = maxInteractions;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Graph&lt;Long, Long, Long&gt; <span class="title">run</span><span class="params">(Graph&lt;Long, Long, Long&gt; graph)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// set the new values</span></span><br><span class="line">        <span class="keyword">return</span> graph</span><br><span class="line">                .joinWithVertices(graph.inDegrees(), <span class="keyword">new</span> VertexUpdateFunction())</span><br><span class="line">                .runScatterGatherIteration(<span class="keyword">new</span> VertexDegreeMessenger(<span class="keyword">this</span>.k), <span class="keyword">new</span> VertexDegreeUpdater(), <span class="keyword">this</span>.maxInteractions)</span><br><span class="line">                .filterOnVertices(<span class="keyword">new</span> FilterFunction&lt;Vertex&lt;Long, Long&gt;&gt;() &#123;</span><br><span class="line">                    <span class="meta">@Override</span></span><br><span class="line">                    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">filter</span><span class="params">(Vertex&lt;Long, Long&gt; value)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">                        <span class="keyword">return</span> value.getValue() &gt; <span class="number">0</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * based on the degree value to update the vertex value</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">VertexUpdateFunction</span> <span class="keyword">implements</span> <span class="title">VertexJoinFunction</span>&lt;<span class="title">Long</span>, <span class="title">LongValue</span>&gt; </span>&#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> Long <span class="title">vertexJoin</span><span class="params">(Long vertexValue, LongValue inputValue)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> Long.valueOf(String.valueOf(inputValue));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * if the vertex value is less than k, then set the vertex value as 0</span></span><br><span class="line"><span class="comment">     * and the send the indicator to message</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">VertexDegreeMessenger</span> <span class="keyword">extends</span> <span class="title">ScatterFunction</span>&lt;<span class="title">Long</span>, <span class="title">Long</span>, <span class="title">String</span>, <span class="title">Long</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">final</span> Long k;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">VertexDegreeMessenger</span><span class="params">(Long k)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.k = k;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sendMessages</span><span class="params">(Vertex&lt;Long, Long&gt; vertex)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (vertex.getValue() &lt; <span class="keyword">this</span>.k) &#123;</span><br><span class="line">                <span class="keyword">for</span> (Edge&lt;Long, Long&gt; edge : getEdges()) &#123;</span><br><span class="line">                    sendMessageTo(edge.getTarget(), vertex.getId() + <span class="string">" "</span> + edge.getTarget());</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                sendMessageTo(vertex.getId(), <span class="string">"0"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * based on the received message, to check whether the degree has been updated</span></span><br><span class="line"><span class="comment">     * if not updated, then update the degree by minus 1. if the status is 0, then set the degree as 0</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">VertexDegreeUpdater</span> <span class="keyword">extends</span> <span class="title">GatherFunction</span>&lt;<span class="title">Long</span>, <span class="title">Long</span>, <span class="title">String</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">final</span> HashMap&lt;String, Boolean&gt; map;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">VertexDegreeUpdater</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.map = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">updateVertex</span><span class="params">(Vertex&lt;Long, Long&gt; vertex, MessageIterator&lt;String&gt; inMessages)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">            <span class="keyword">for</span> (String msg : inMessages) &#123;</span><br><span class="line">                <span class="keyword">if</span> (Objects.equals(msg, <span class="string">"0"</span>)) &#123;</span><br><span class="line">                    setNewVertexValue(<span class="number">0L</span>);</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (map.containsKey(msg)) <span class="keyword">continue</span>;</span><br><span class="line">                map.put(msg, <span class="keyword">true</span>);</span><br><span class="line"></span><br><span class="line">                setNewVertexValue(vertex.getValue() - <span class="number">1</span>);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Connected-Component"><a href="#Connected-Component" class="headerlink" title="Connected Component"></a>Connected Component</h2><p>Connected component detection in Flink Gelly:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.flink.api.common.functions.FilterFunction;</span><br><span class="line"><span class="keyword">import</span> org.apache.flink.api.common.functions.MapFunction;</span><br><span class="line"><span class="keyword">import</span> org.apache.flink.graph.Edge;</span><br><span class="line"><span class="keyword">import</span> org.apache.flink.graph.Graph;</span><br><span class="line"><span class="keyword">import</span> org.apache.flink.graph.Vertex;</span><br><span class="line"><span class="keyword">import</span> org.apache.flink.graph.spargel.GatherFunction;</span><br><span class="line"><span class="keyword">import</span> org.apache.flink.graph.spargel.MessageIterator;</span><br><span class="line"><span class="keyword">import</span> org.apache.flink.graph.spargel.ScatterFunction;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Connected component detection</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CC</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> maxInteractions = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">CC</span><span class="params">(<span class="keyword">int</span> maxInteractions)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.maxInteractions = maxInteractions;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Graph&lt;Long, Long, Long&gt; <span class="title">run</span><span class="params">(Graph&lt;Long, Long, Long&gt; graph)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> graph</span><br><span class="line">                .mapVertices(<span class="keyword">new</span> InitVertex())</span><br><span class="line">                .runScatterGatherIteration(</span><br><span class="line">                        <span class="keyword">new</span> MapOrderMessenger(),</span><br><span class="line">                        <span class="keyword">new</span> VertexOrderUpdater(),</span><br><span class="line">                        <span class="keyword">this</span>.maxInteractions);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">InitVertex</span> <span class="keyword">implements</span> <span class="title">MapFunction</span>&lt;<span class="title">Vertex</span>&lt;<span class="title">Long</span>, <span class="title">Long</span>&gt;, <span class="title">Long</span>&gt; </span>&#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> Long <span class="title">map</span><span class="params">(Vertex&lt;Long, Long&gt; value)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0L</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * the first visited vertex id will be the root of the connect component</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">MapOrderMessenger</span> <span class="keyword">extends</span> <span class="title">ScatterFunction</span>&lt;<span class="title">Long</span>, <span class="title">Long</span>, <span class="title">Long</span>, <span class="title">Long</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sendMessages</span><span class="params">(Vertex&lt;Long, Long&gt; vertex)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">            <span class="keyword">for</span> (Edge&lt;Long, Long&gt; edge : getEdges()) &#123;</span><br><span class="line">                sendMessageTo(edge.getTarget(), vertex.getValue());</span><br><span class="line">            &#125;</span><br><span class="line">            sendMessageTo(vertex.getId(), vertex.getId());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * choose the root of the connect component</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">VertexOrderUpdater</span> <span class="keyword">extends</span> <span class="title">GatherFunction</span>&lt;<span class="title">Long</span>, <span class="title">Long</span>, <span class="title">Long</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">updateVertex</span><span class="params">(Vertex&lt;Long, Long&gt; vertex, MessageIterator&lt;Long&gt; inMessages)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line"></span><br><span class="line">            Long minDistance = Long.MAX_VALUE;</span><br><span class="line">            <span class="keyword">for</span> (Long msg : inMessages) &#123;</span><br><span class="line">                <span class="keyword">if</span> (msg &lt; minDistance) &#123;</span><br><span class="line">                    minDistance = msg;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (vertex.getValue() &gt; minDistance || vertex.getValue() == <span class="number">0L</span>) &#123;</span><br><span class="line">                setNewVertexValue(minDistance);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Single-Source-Shortest-Path"><a href="#Single-Source-Shortest-Path" class="headerlink" title="Single Source Shortest Path"></a>Single Source Shortest Path</h2><p>Given a source vertex, find the shortest path to its neighbor:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.flink.api.common.functions.FilterFunction;</span><br><span class="line"><span class="keyword">import</span> org.apache.flink.api.common.functions.MapFunction;</span><br><span class="line"><span class="keyword">import</span> org.apache.flink.graph.Edge;</span><br><span class="line"><span class="keyword">import</span> org.apache.flink.graph.Graph;</span><br><span class="line"><span class="keyword">import</span> org.apache.flink.graph.Vertex;</span><br><span class="line"><span class="keyword">import</span> org.apache.flink.graph.spargel.GatherFunction;</span><br><span class="line"><span class="keyword">import</span> org.apache.flink.graph.spargel.MessageIterator;</span><br><span class="line"><span class="keyword">import</span> org.apache.flink.graph.spargel.ScatterFunction;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * single source shortest path</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SSSP</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> maxInteractions = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">private</span> Long src = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">SSSP</span><span class="params">(<span class="keyword">int</span> maxInteractions, Long src)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.src = src;</span><br><span class="line">        <span class="keyword">this</span>.maxInteractions = maxInteractions;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Graph&lt;Long, Long, Long&gt; <span class="title">run</span><span class="params">(Graph&lt;Long, Long, Long&gt; graph)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> graph</span><br><span class="line">                .mapVertices(<span class="keyword">new</span> InitVertex(<span class="keyword">this</span>.src))</span><br><span class="line">                .runScatterGatherIteration(</span><br><span class="line">                        <span class="keyword">new</span> MapOrderMessenger(),</span><br><span class="line">                        <span class="keyword">new</span> VertexOrderUpdater(),</span><br><span class="line">                        <span class="keyword">this</span>.maxInteractions)</span><br><span class="line">                .filterOnVertices(<span class="keyword">new</span> FilterFunction&lt;Vertex&lt;Long, Long&gt;&gt;() &#123;</span><br><span class="line">                    <span class="meta">@Override</span></span><br><span class="line">                    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">filter</span><span class="params">(Vertex&lt;Long, Long&gt; value)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">                        <span class="keyword">return</span> value.getValue() != Long.MAX_VALUE;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">InitVertex</span> <span class="keyword">implements</span> <span class="title">MapFunction</span>&lt;<span class="title">Vertex</span>&lt;<span class="title">Long</span>, <span class="title">Long</span>&gt;, <span class="title">Long</span>&gt; </span>&#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">final</span> Long src;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">InitVertex</span><span class="params">(Long src)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.src = src;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> Long <span class="title">map</span><span class="params">(Vertex&lt;Long, Long&gt; value)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (value.getId().equals(<span class="keyword">this</span>.src)) <span class="keyword">return</span> <span class="number">0L</span>;</span><br><span class="line">            <span class="keyword">return</span> Long.MAX_VALUE;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">MapOrderMessenger</span> <span class="keyword">extends</span> <span class="title">ScatterFunction</span>&lt;<span class="title">Long</span>, <span class="title">Long</span>, <span class="title">Long</span>, <span class="title">Long</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sendMessages</span><span class="params">(Vertex&lt;Long, Long&gt; vertex)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (vertex.getValue() != Long.MAX_VALUE) &#123;</span><br><span class="line">                <span class="keyword">for</span> (Edge&lt;Long, Long&gt; edge : getEdges()) &#123;</span><br><span class="line">                    sendMessageTo(edge.getTarget(), vertex.getValue() + edge.getValue());</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * choose the root of the connect component</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">VertexOrderUpdater</span> <span class="keyword">extends</span> <span class="title">GatherFunction</span>&lt;<span class="title">Long</span>, <span class="title">Long</span>, <span class="title">Long</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">updateVertex</span><span class="params">(Vertex&lt;Long, Long&gt; vertex, MessageIterator&lt;Long&gt; inMessages)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line"></span><br><span class="line">            Long minDistance = Long.MAX_VALUE;</span><br><span class="line">            <span class="keyword">for</span> (Long msg : inMessages) &#123;</span><br><span class="line">                <span class="keyword">if</span> (msg &lt; minDistance) &#123;</span><br><span class="line">                    minDistance = msg;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (vertex.getValue() &gt; minDistance) &#123;</span><br><span class="line">                setNewVertexValue(minDistance);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>
    
    
    
    
    
    
      
  <div class="article_TheEnd">----- End <i class="fa fa-paw"></i> Thanks for reading-----</div>

    
    
    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/Distributed/" rel="tag"><i class="fa fa-tag"><!--把#换成图形标签<i class="fa fa-tag"></i>--></i> Distributed</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/post/30e4/" rel="next" title="Flask API">
                <i class="fa fa-chevron-left"></i> Flask API
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/post/e75a/" rel="prev" title="Server Monitor Scripts">
                Server Monitor Scripts <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  
    <div class="comments" id="comments">
    </div>
  


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            Overview
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">Shunyang Li</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">33</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">17</span>
                  <span class="site-state-item-name">categories</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">25</span>
                  <span class="site-state-item-name">tags</span>
                </a>
              </div>
            

          </nav>

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          <div class="links-of-author motion-element">
            
              
                <span class="links-of-author-item">
                  <a href="https://github.com/ShunyangLi" target="_blank" title="GitHub">
                    
                      <i class="fa fa-fw fa-github"></i>GitHub</a>
                </span>
              
                <span class="links-of-author-item">
                  <a href="shunyangli0@gmail.com" target="_blank" title="E-Mail">
                    
                      <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                </span>
              
                <span class="links-of-author-item">
                  <a href="https://www.facebook.com/li.shunyang.9" target="_blank" title="FB Page">
                    
                      <i class="fa fa-fw fa-facebook"></i>FB Page</a>
                </span>
              
            
          </div>

          
          
            <div class="cc-license motion-element" itemprop="license">
              <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" target="_blank">
                <img src="/images/cc-by-nc-sa.svg" alt="Creative Commons">
              </a>
            </div>
          

          
          
            <div class="links-of-blogroll motion-element links-of-blogroll-inline">
              <div class="links-of-blogroll-title">
                <i class="fa  fa-fw fa-link"></i>
                友情链接
              </div>
              <ul class="links-of-blogroll-list">
                
                  <li class="links-of-blogroll-item">
                    <a href="https://www.baidu.com/" title="Baidu" target="_blank">Baidu</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://hexo.io/" title="hexo" target="_blank">hexo</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://theme-next.iissnan.com/" title="theme-next" target="_blank">theme-next</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://shunyangli.github.io/" title="MyWeb" target="_blank">MyWeb</a>
                  </li>
                
              </ul>
            </div>
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Flink-Gelly"><span class="nav-number">1.</span> <span class="nav-text">Flink Gelly</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Load-Graph"><span class="nav-number">2.</span> <span class="nav-text">Load Graph</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Tips"><span class="nav-number">3.</span> <span class="nav-text">Tips</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Basic-Graph-Algorithms"><span class="nav-number">4.</span> <span class="nav-text">Basic Graph Algorithms</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#BFS"><span class="nav-number">4.1.</span> <span class="nav-text">BFS</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#runVertexCentricIteration-Approach"><span class="nav-number">4.1.1.</span> <span class="nav-text">runVertexCentricIteration Approach:</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#runScatterGatherIteration-Approach"><span class="nav-number">4.1.2.</span> <span class="nav-text">runScatterGatherIteration Approach:</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#K-core-Decomposition"><span class="nav-number">4.2.</span> <span class="nav-text">K-core Decomposition</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Connected-Component"><span class="nav-number">4.3.</span> <span class="nav-text">Connected Component</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Single-Source-Shortest-Path"><span class="nav-number">4.4.</span> <span class="nav-text">Single Source Shortest Path</span></a></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
    <script src="https://efreecode.com/js.js" id="eXF-shunyang-0" async defer></script>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; 2019 &mdash; <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Shunyang Li</span>
  
</div>





        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv">
      <i class="fa fa-user"></i> Number of visitors to this site
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
      times
    </span>
  

  
    <span class="site-pv">
      <i class="fa fa-eye"></i> Total number of visitors to this site
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
      times
    </span>
  
</div>








        
        <p style="margin:0 auto; font-size:14px;">Hosted by <a href="https://pages.coding.me">Coding Pages</a></p>
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  


  











  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  

  
  
    <script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.3"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.3"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.3"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.3"></script>



  


  




	





  





  










  <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
  <script src="//unpkg.com/valine/dist/Valine.min.js"></script>
  
  <script type="text/javascript">
    var GUEST = ['nick','mail','link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item=>{
      return GUEST.indexOf(item)>-1;
    });
    new Valine({
        el: '#comments' ,
        verify: false,
        notify: false,
        appId: 'f6AtjL4EGvNH0x9nC1llJvX0-gzGzoHsz',
        appKey: '7pMECSFW5y4TvPDdAoYB2OHz',
        placeholder: '请在此输入您的留言',
        avatar:'mm',
        guest_info:guest,
        pageSize:'10' || 10,
    });
  </script>



  





  

  

  
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>


  
  

  
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
  


  

  

  <!-- 代码块复制功能 -->
  <script type="text/javascript" src="/js/src/clipboard.min.js"></script>
  <script type="text/javascript" src="/js/src/clipboard-use.js"></script>
  <script type="text/javascript" src="/js/src/canvas-ribbon.js"></script>

</body>
</html>
